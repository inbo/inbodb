<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>odbc query problem • inbodb</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="odbc query problem">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">inbodb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../news/index.html">NEWS</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../CONTRIBUTING.html">Contributing</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/inbo/inbodb" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
<li>
  <a href="https://twitter.com/INBOVlaanderen" class="external-link">
    <span class="fa fa-twitter"></span>

  </a>
</li>
<li>
  <a href="https://www.facebook.com/pg/INBOVlaanderen" class="external-link">
    <span class="fa fa-facebook"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>odbc query problem</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/inbo/inbodb/blob/main/vignettes/odbc_query_problem.Rmd" class="external-link"><code>vignettes/odbc_query_problem.Rmd</code></a></small>
      <div class="hidden name"><code>odbc_query_problem.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="description-of-the-problem">Description of the problem<a class="anchor" aria-label="anchor" href="#description-of-the-problem"></a>
</h3>
<p>If a query is fetched against a odbc based database connection, an
error occurs if long data types (<code>varchar(max)</code>,
<code>nvarchar(max)</code>, <code>text</code>, <code>ntext</code>,
<code>xml</code>, <code>geography</code>, <code>geometry</code>,
<code>hierarchyid</code>, <code>binary</code>, <code>image</code> or
<code>rowversion</code>) are not put at the end of the select statement.
As it is not in our power to change this shortcoming, we replaced the
original cryptic warning by an informative one mentioning the columns
that should be put in the end of the select statement.</p>
<p><strong>This problem has been solved from
<code>odbc 1.2.3</code></strong>, so we recommend installing an update
of this package. Shortly the adapted warning and this vignette will be
removed from <code>inbodb</code>.</p>
</div>
<div class="section level3">
<h3 id="some-background-on-sql-server-and-odbc-data-types">Some background on SQL Server and odbc data types<a class="anchor" aria-label="anchor" href="#some-background-on-sql-server-and-odbc-data-types"></a>
</h3>
<p>It seems that the error corresponds to the native data types in the
SQL Server database (with the exception that data type <code>xml</code>
causes an error in Windows OS but not in Unix OS). These data types are
however translated to odbc data types that do not always correspond to
the native types, and the latter are OS dependent. E.g. the native data
type <code>nvarchar(max)</code> becomes odbc type <code>ntext</code> in
Windows OS and <code>nvarchar</code> in Unix OS. The data types that are
shown in RStudio in the Connections pane, are the odbc data types.</p>
<p>In Windows OS, luckily, native long data types always correspond to
odbc long data types, and vice versa (despite the fact that de exact
data types do not always correspond). In Unix OS, the native long data
types <code>nvarchar(max)</code> and <code>varchar(max)</code>
correspond to the odbc ‘short’ data types <code>nvarchar</code> and
<code>varchar</code>. So in Windows the data types shown in the RStudio
Connection pane can be used to determine which columns should be placed
in the end of the select statement. In Unix, the native data types
should be checked (or should additionally be checked for
<code>nvarchar(max)</code> and <code>varchar(max)</code>).</p>
</div>
<div class="section level3">
<h3 id="consulting-data-types">Consulting data types<a class="anchor" aria-label="anchor" href="#consulting-data-types"></a>
</h3>
<p>The native data types can be consulted:</p>
<ul>
<li>directly in SQL Server via applications such as Microsoft SQL Server
Management Studio or Azure Data Studio</li>
<li>in R by querying separate tables with
<code>dbGetQuery(con, "sp_columns 'table_name'")</code> (with
<code>con</code> the connection to the database and
<code>table_name</code> the name of the table)</li>
</ul>
<p>The odbc data types can be consulted:</p>
<ul>
<li>in the Connections pane in RStudio</li>
<li>in R by querying separate tables with
<code>odbc::odbcConnectionColumns(con, "table_name")</code> (with
<code>con</code> the connection to the database and
<code>table_name</code> the name of the table)</li>
<li>once you know the corresponding ID’s in column
<code>data_type</code>, these ID’s can be consulted for a specific query
using the following code:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html" class="external-link">dbSendQuery</a></span><span class="op">(</span><span class="va">con</span>, <span class="va">query</span><span class="op">)</span></span>
<span><span class="fu">odbc</span><span class="fu">::</span><span class="fu">dbColumnInfo</span><span class="op">(</span><span class="va">rs</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Els Lommelen, Hans Van Calster, Els De Bie, Floris Vanderhaeghe, Frederic Piesschaert, Toon Westra, <a href="https://www.vlaanderen.be/inbo/en-gb" class="external-link"><img src="https://inbo.github.io/checklist/reference/figures/logo-en.png" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
